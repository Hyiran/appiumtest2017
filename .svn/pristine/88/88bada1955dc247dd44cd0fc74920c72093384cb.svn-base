package com.oribo.android365.testcase;

import java.util.logging.Logger;

import org.junit.Assert;
import org.openqa.selenium.By;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Listeners;
import org.testng.annotations.Test;

import com.oribo.ReadExcelCase.ReadExcel;
import com.oribo.common.AppOperate;
import com.oribo.dataprovider.Constant;
import com.oribo.common.TestcaseFrame;
import com.oribo.dataprovider.AppBean;
import com.oribo.dataprovider.DataBean;
import com.oribo.dataprovider.ExcelData;
import com.oribo.log.LoggerUtil;
import com.oribo.report.CreateHtmlreport;
import com.oribo.report.MessageOutput;
import com.oribo.report.TestResultListener;
import com.oribo.utils.FileOperate;

import io.appium.java_client.android.AndroidDriver;

@Listeners({TestResultListener.class})
public class PhTestDome extends TestcaseFrame{
	Logger eventLogger=null;
	AndroidDriver driver=null;
	
	
	@BeforeClass
	public void beforeClass()
	{   
		super.testSetUp();
		driver=super.getDriver();
		//create HTML report
		CreateHtmlreport.createHtmlLog();
		//create eventLog
		eventLogger =LoggerUtil.getwriteFileLog(Constant.PENGHONG,AppBean.getAppBean().getApk()+"_"+AppBean.getAppBean().getPhone()+"_"+"中心红", PhTestDome.class);
		//read testcas
		ReadExcel  excel =  new ReadExcel();
		ExcelData  excelData =  new ExcelData();
		excelData.setNumerSheet(6);
		excelData.setCaseType(Constant.CASETYPE_ANDROID);
		excel.readXls("personInfo_TestData.xls", excelData,bean);
		
		
	}
	@Test
	public void logging()
	{   
		newSleep(2);
		DataBean  data = bean.get(0);
		String casename=data.getTestCaseName();
		AppOperate.click(driver.findElement(By.name("我的")), "点击'我的'");
		System.out.println("start---");
		System.out.println("end---");
		AppOperate.click(driver.findElement(By.id(data.getElementAttribute())), "点击个人中心的头像");//第二个参数指步骤
		try {
			Assert.assertNotNull(driver.findElementByName("退出登录"));
			//截图
			screenCap(driver, casename);
			CreateHtmlreport.writeToLog(data.getTestCaseName(), data.getInstructions(),data.getExpectValue(), "跟期望值一样", "PASS");
				
		} catch (Exception e) {
			// TODO: handle exception
			CreateHtmlreport.writeToLog(data.getTestCaseName(),data.getInstructions(),data.getExpectValue(), data.getActualValue(), "FAIL");//第二个参数指功能点，用例第一项
		}
		
	}
	
	
	@AfterClass
	public void afterClass()
	{
		driver.quit();
		CreateHtmlreport.closeLog();
		
		
	}

}
