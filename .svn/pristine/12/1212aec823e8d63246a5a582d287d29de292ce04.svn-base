package com.oribo.android365.testcase;
import org.testng.annotations.Test;

import com.oribo.common.Capabilities;
import com.oribo.common.Driver;
import com.oribo.common.SaveUserInfo;
import com.oribo.common.TestcaseFrame;
import com.oribo.dataprovider.AppBean;
import com.oribo.utils.GetElementUtil;

import io.appium.java_client.android.AndroidDriver;
import io.appium.java_client.android.AndroidElement;
import java.io.File;
import java.util.List;
import java.util.concurrent.TimeUnit;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.remote.CapabilityType;
import org.openqa.selenium.remote.DesiredCapabilities;
import org.openqa.selenium.support.ui.ExpectedCondition;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Parameters;
import org.testng.annotations.BeforeSuite;
public class StartAppiumTest extends TestcaseFrame {
	public String appport ;//  端口号
	public String appudid;// 手机Udid 
	public String testphone;//  测试手机
	public String appplatformVersion;//手机的版本号
	public String appapk;//测试的App 包
	AndroidDriver driver=null;
	/**
	 * 此类作用为启动APP，然后进行登录
	 * 设置测试环境
	 * @param port  启动的端口好
	 * @param udid 手机的IDID
	 * @param platformVersion  手机系统
	 * @param apk  测试的apk
	 */
	@BeforeTest
	@Parameters({ "port", "udid","phone","platformVersion", "apk","testaccount","testpassword"})
	public void beforeSuite(String port, String udid,String phone,String platformVersion ,String apk,String testaccount,String testpassword ){
		appport = port;
		appudid = udid;
		testphone = phone;
		appplatformVersion = platformVersion;
		appapk =apk;
		account = testaccount;
		password = testpassword;
	}
	
	@BeforeTest
	public void startApp() {
	//保存app的基础信息		
		AppBean   appbean = AppBean.getAppBean();
		appbean.setUid(appudid);
		appbean.setPort( appport);
		appbean.setPhone(testphone);
		appbean.setApk(appapk);
		appbean.setPlatformVersion(appplatformVersion);
		//保存登录账号信息
		SaveUserInfo.getUserInfo().setAccount(account);
		SaveUserInfo.getUserInfo().setPassWord(password);
		    super.testSetUp();
			//配置app测试环境，并启动被测app
			newSetUp();
			driver = super.getDriver();

	
	
	}

	@Test
	public void test() {
		System.out.println("11111 "+driver.currentActivity());
		if(driver.currentActivity().equals(".user.LoginActivity"))
		{
		//登录页面
		List<AndroidElement> edittext = GetElementUtil.getEdit(null,"");
			 edittext.get(0).clear();
			 edittext.get(0).sendKeys(SaveUserInfo.getUserInfo().getAccount());
			 edittext.get(1).clear(); 
			 edittext.get(1).sendKeys(SaveUserInfo.getUserInfo().getPassWord()); 
		 GetElementUtil.getEelememtByName(null, "登录").click();	
		}

	}
	
	@AfterClass
	public void afterClass()
	{
		System.out.println("**********");
		driver.quit();
		
	}

}
